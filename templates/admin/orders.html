{% extends "base.html" %}
{% block title %}Admin - Pedidos{% endblock %}

{% block content %}
<section class="container main">
  <div style="display:flex; gap:12px; align-items:flex-end; justify-content:space-between; flex-wrap:wrap;">
    <div>
      <h1 class="page-title" style="margin-bottom:6px;">Pedidos</h1>
      <p class="page-subtitle">Listado de pedidos (Appwrite).</p>
    </div>

    <div style="display:flex; gap:10px; flex-wrap:wrap;">
      <a class="btn-outline" href="/admin">Volver</a>
      <button class="btn-outline" type="button" onclick="location.reload()">Refrescar</button>
    </div>
  </div>

  {% if not orders or orders|length == 0 %}
    <div class="summary-box" style="margin-top:14px;">
      <strong>No hay pedidos todav√≠a.</strong>
      <p class="muted" style="margin-top:6px;">Cuando un cliente confirme un checkout, apareceran aqui.</p>
    </div>
  {% else %}

    <div class="cart__items" style="margin-top:14px;">
      {% for o in orders %}
        <div class="cart__item" style="grid-template-columns: 1fr auto; align-items:start;">
          <div>
            <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
              <div style="font-weight:900; font-size:18px;">
                Pedido {{ o["$id"] }}
              </div>

              {% set st = (o.status or 'nuevo') %}
              <span class="muted" style="border:1px solid rgba(212,175,55,.25); padding:4px 10px; border-radius:999px; font-weight:800;">
                {{ st }}
              </span>
            </div>

            <div class="muted" style="margin-top:8px; display:grid; gap:4px;">
              <div><strong>Nombre:</strong> {{ o.full_name }}</div>
              <div><strong>WhatsApp:</strong> {{ o.phone }}</div>
              <div><strong>Ciudad:</strong> {{ o.city }}</div>
            </div>
          </div>

          <div style="text-align:right; min-width:220px;">
            <div class="muted" style="font-weight:800;">Acciones</div>
            <div style="display:grid; gap:8px; margin-top:8px;">
              <a class="btn-outline" href="/admin/orders/{{ o['$id'] }}">Abrir</a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

  {% endif %}
</section>
{% endblock %}
